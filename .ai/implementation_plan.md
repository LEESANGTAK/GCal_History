# 자동완성 소스를 기존 구글 캘린더 일정으로 변경하기

현재 확장 프로그램은 사용자가 직접 입력한 이벤트만 로컬에 저장하여 자동완성에 사용하고 있습니다. 새로운 요구사항은 사용자의 구글 캘린더에 이미 등록되어 있는 실제 일정을 가져와서 자동완성에 사용하는 것입니다.

## 사용자 검토 필요사항
> [!IMPORTANT]
> 확장 프로그램에서 사용자의 구글 캘린더에 직접 접근하려면, 구글 클라우드 프로젝트(Google Cloud Project)를 설정하고 구글 캘린더 API를 활성화한 후, OAuth 2.0 클라이언트 자격 증명을 생성해야 합니다.
>
> **사용자 조치 필요사항:**
> 1. 구글 클라우드 콘솔(Google Cloud Console)(https://console.cloud.google.com/)로 이동합니다.
> 2. 새 프로젝트를 생성하거나 기존 프로젝트를 선택합니다.
> 3. **Google Calendar API**를 활성화합니다.
> 4. **OAuth 동의 화면(OAuth consent screen)**을 구성합니다.
> 5. **OAuth 2.0 클라이언트 ID(OAuth 2.0 Client ID)** 자격 증명을 생성합니다 (애플리케이션 유형: Chrome 확장 프로그램).
> 6. 저에게 **클라이언트 ID(Client ID)**를 제공해주세요.
>
> 또는, (OAuth 없이) 현재 열려있는 캘린더 페이지의 DOM에서만 이벤트를 가져오고 싶다면, 화면에 보이는 일정만 스크래핑할 수 있습니다. **어떤 접근 방식을 선호하시나요?**
> - **방식 A (OAuth API):** 모든 일정을 안정적으로 가져오지만, 구글 클라우드 프로젝트 설정이 필요합니다.
> - **방식 B (DOM 스크래핑):** 설정이 훨씬 간편하지만(API 키 불필요), 현재 캘린더 화면에 보이는 일정만 가져올 수 있습니다.

## 제안된 변경 사항

**방식 A (OAuth API)**로 진행한다고 가정했을 때 제안하는 변경 사항은 다음과 같습니다:

### 매니페스트 변경 사항
#### [MODIFY] manifest.json
- `identity` 권한 추가.
- `client_id` 및 `scopes`(`https://www.googleapis.com/auth/calendar.readonly`)이 포함된 `oauth2` 항목 추가.

### 백그라운드 스크립트 (신규)
#### [NEW] background.js
- `chrome.identity.getAuthToken`을 사용하여 인증 관리.
- `https://www.googleapis.com/calendar/v3/calendars/primary/events`에서 일정 가져오기.
- 메시징을 통해 가져온 일정을 `content.js`로 보내거나 `chrome.storage.local`에 저장하여 공유.

### 콘텐츠 스크립트
#### [MODIFY] content.js
- 과거 입력 이력 기반인 기존 `historyData` 객체 대신, API에서 가져온 실제 일정을 사용.
- 구글 캘린더에서 가져온 일정 데이터를 기준으로 자동완성 필터링 로직 수정.

## 검증 계획

### 자동화된 테스트
- 현재 사용 가능한 자동화 테스트가 없으므로 파일 수정 후 수동으로 검증합니다.

### 수동 검증
1. 크롬에 압축 해제된 확장 프로그램으로 로드합니다.
2. 구글 캘린더를 엽니다.
3. 새 일정 추가 창을 클릭합니다.
4. 자동완성 드롭다운을 열면 사용자의 캘린더에 이미 존재하는 실제 일정들이 나타나는지 확인합니다.
5. 항목을 선택하면 제목(및 API에서 제공하는 경우 위치/설명)이 입력 필드에 자동으로 채워지는지 확인합니다.
